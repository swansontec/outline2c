#include <stdio.h>

@o2c include "test.ol";

/* List the settings in a single location: */
@o2c outline settings {
  number width;
  number height;
  number threads;
  string username;
  string save_dir;
}

/* Generate a structure to hold the settings: */
typedef struct {
  @o2c map type {
    number { int }
    string { char * }
  }
  @o2c for setting in settings { setting!type setting; }
} Settings;

/* Generate a function to save the settings: */
void save_settings(Settings *s, FILE *f)
{
  @o2c map format {
    number {"%s=%d\n"}
    string {"%s=%s\n"}
  }
  @o2c for setting in settings {
    fprintf(f, setting!format, setting!quote, s->setting); }
}

int main(int argc, char *argv[])
{
  return 0;
}

/* Test nested outlines: */
@o2c outline test_nesting {
  item0 { sub0; sub1; }
  item1 { sub2; sub3; }
  item2;
}
@o2c for i in test_nesting {
  i: @o2c for j in . { j; }
}

/* Test pasting: */
@o2c outline test_paste { thing; }
@o2c for i in test_paste { some\\i\\_test }
foo\\bar
